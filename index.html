<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Y2K | Roast Records</title>
  <meta name="description" content="The official site of Y2K | Roast Records â€” a premium Web3 music label on Cronos." />
  <meta name="theme-color" content="#000000" />
  <link rel="icon" href="https://raw.githubusercontent.com/LandoCrissian/Y2kCoin-Website/main/AC6583AD-EE37-486D-8220-6555D24B0D9D.png" />
  <style>
    body {
      margin: 0;
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #0a0a0a;
      color: #f5f5f5;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background-color: #000;
      border-bottom: 1px solid #222;
    }
    .logo {
      font-size: 20px;
      font-weight: bold;
      color: #f5f5f5;
      text-transform: uppercase;
    }
    .wallet-btn {
      background-color: #d6b66c;
      color: #000;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    .hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;
    }
    .hero h1 {
      font-size: 32px;
      margin-bottom: 12px;
    }
    .hero p {
      font-size: 16px;
      color: #ccc;
      max-width: 600px;
    }
    section {
      padding: 40px 20px;
      border-top: 1px solid #1a1a1a;
    }
    h2 {
      font-size: 22px;
      margin-bottom: 16px;
      color: #d6b66c;
    }
    form input, form textarea, form select {
      display: block;
      width: 100%;
      margin-bottom: 16px;
      padding: 10px;
      font-size: 16px;
      background: #111;
      color: #f5f5f5;
      border: 1px solid #333;
      border-radius: 6px;
    }
    form button {
      padding: 12px 24px;
      font-size: 16px;
      font-weight: bold;
      background-color: #d6b66c;
      color: #000;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .track-card {
      background-color: #111;
      border: 1px solid #222;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 20px;
    }
    .admin-panel {
      background: #111;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #333;
    }
    .hidden { display: none; }
  </style>

  <!-- WalletConnect / Web3Modal v2 -->
<script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web3modal@1.9.5/dist/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
</head>
<body>
  <header>
    <div class="logo">Y2K | Roast Records</div>
    <button id="connectWallet" class="wallet-btn">Connect Wallet</button>
  </header>

  <!-- Toast Container -->
<div id="toast" style="
  display:none;
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #d6b66c;
  color: #000;
  padding: 14px 24px;
  border-radius: 8px;
  font-weight: bold;
  font-size: 14px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  z-index: 9999;
  transition: all 0.3s ease;
"></div>

  <div class="hero">
    <h1>A New Era of Music</h1>
    <p>Y2K | Roast Records is the first premium Web3 label for real and AI artists â€” built on Cronos, powered by community, and open to anyone who dares to drop heat.</p>
  </div>

    <section id="submissionSection" class="hidden">
    <h2>Submit Your Track</h2>
    <form id="trackForm">
      <input type="text" id="projectName" placeholder="Project / Artist Name" required />
      <input type="text" id="twitterHandle" placeholder="ð• / Twitter Handle" required />
      <select id="vibeSelect" required>
        <option value="">Select Genre Vibe</option>
        <option value="glitch">Glitch</option>
        <option value="dub">Dub</option>
        <option value="trap">Trap</option>
        <option value="ai">AI Generated</option>
        <option value="other">Other</option>
      </select>
      <textarea id="notes" rows="3" placeholder="Optional Notes or Ideas"></textarea>
      <button type="submit">Submit Track</button>
    </form>
  </section>

  <section id="certifiedTracks">
    <h2>Certified Tracks</h2>
    <div id="certifiedList"></div>
  </section>

  <section id="adminPanel" class="hidden">
    <h2>Admin Panel</h2>
    <div class="admin-panel">
      <p><strong>Pending Submissions</strong></p>
      <div id="pendingList"></div>
    </div>
  </section>

  <!-- Firebase + JS Logic -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore-compat.js"></script>
  <script>
    // ðŸ” Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyByE3Z0Ui_aFr1JUgVzw3ZDatGv8DzqVcE",
      authDomain: "y2kroastrecords.firebaseapp.com",
      projectId: "y2kroastrecords",
      storageBucket: "y2kroastrecords.appspot.com",
      messagingSenderId: "313829428782",
      appId: "1:313829428782:web:4e42771ba525f6f297d9bf"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const connectBtn = document.getElementById("connectWallet");
    const submissionSection = document.getElementById("submissionSection");
    const adminPanel = document.getElementById("adminPanel");
    const certifiedList = document.getElementById("certifiedList");
    const pendingList = document.getElementById("pendingList");

    let userAddress = null;
    const adminWallet = "0x7FC2AB08F46C10489Bab5D694D574022f1048198".toLowerCase();

        // ðŸ”Œ Wallet Connect Logic
     let web3Modal;
  let provider;
  let web3;
  let selectedAccount = null;
  const adminWallet = "0x7FC2AB08F46C10489Bab5D694D574022f1048198".toLowerCase();

  async function initWalletModal() {
    const providerOptions = {
      walletconnect: {
        package: window.WalletConnectProvider.default,
        options: {
          rpc: {
            25: "https://evm.cronos.org"
          },
          chainId: 25
        }
      }
    };

    web3Modal = new window.Web3Modal.default({
      cacheProvider: false,
      providerOptions
    });
  }

  async function connectWallet() {
    try {
      provider = await web3Modal.connect();
      web3 = new Web3(provider);

      const accounts = await web3.eth.getAccounts();
      selectedAccount = accounts[0].toLowerCase();

      const chainId = await web3.eth.getChainId();
      if (chainId !== 25) {
        showToast("Please switch to Cronos network (Chain ID 25)");
        return;
      }

      // SIGN MESSAGE
      const message = "Sign to connect to Y2K | Roast Records";
      await web3.eth.personal.sign(message, selectedAccount, "");

      // UI Updates
      const short = `${selectedAccount.slice(0, 6)}...${selectedAccount.slice(-4)}`;
      connectBtn.textContent = short;
      connectBtn.onclick = disconnectWallet;

      submissionSection.classList.remove("hidden");
      if (selectedAccount === adminWallet) {
        adminPanel.classList.remove("hidden");
        loadPendingTracks();
      }
      loadCertifiedTracks();

    } catch (err) {
      console.error("Wallet connection failed:", err);
      showToast("Connection failed.");
    }
  }

  function disconnectWallet() {
    provider = null;
    selectedAccount = null;
    web3Modal.clearCachedProvider();
    connectBtn.textContent = "Connect Wallet";
    connectBtn.onclick = connectWallet;
    submissionSection.classList.add("hidden");
    adminPanel.classList.add("hidden");
  }

  // Init modal on page load
  window.addEventListener("load", () => {
    initWalletModal();
    connectBtn.onclick = connectWallet;
  });

    // ðŸ“ Submit Track to Firestore
    document.getElementById("trackForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("projectName").value;
      const twitter = document.getElementById("twitterHandle").value;
      const vibe = document.getElementById("vibeSelect").value;
      const notes = document.getElementById("notes").value;

      await db.collection("tracks").add({
        name,
        twitter,
        vibe,
        notes,
        wallet: userAddress,
        timestamp: Date.now(),
        certified: false,
        ipfs: ""
      });

      alert("Track submitted!");
      e.target.reset();
    });

    // ðŸŽ§ Load Certified Tracks
    async function loadCertifiedTracks() {
      const snapshot = await db.collection("tracks").where("certified", "==", true).orderBy("timestamp", "desc").get();
      certifiedList.innerHTML = "";
      snapshot.forEach(doc => {
        const data = doc.data();
        const card = document.createElement("div");
        card.className = "track-card";
        card.innerHTML = `
          <strong>${data.name}</strong><br/>
          <small>${data.vibe} â€” ${data.twitter}</small><br/><br/>
          <audio controls src="https://ipfs.io/ipfs/${data.ipfs}" style="width:100%"></audio>
        `;
        certifiedList.appendChild(card);
      });
    }

    // ðŸ› ï¸ Load & Certify Tracks (Admin Only)
    async function loadPendingTracks() {
      const snapshot = await db.collection("tracks").where("certified", "==", false).orderBy("timestamp", "desc").get();
      pendingList.innerHTML = "";
      snapshot.forEach(doc => {
        const data = doc.data();
        const card = document.createElement("div");
        card.className = "track-card";
        card.innerHTML = `
          <strong>${data.name}</strong><br/>
          <small>${data.vibe} â€” ${data.twitter}</small><br/>
          Wallet: ${data.wallet}<br/>
          Notes: ${data.notes || "â€”"}<br/><br/>
          <input type="text" placeholder="IPFS link" id="ipfs-${doc.id}" />
          <button onclick="certifyTrack('${doc.id}')">Certify</button>
        `;
        pendingList.appendChild(card);
      });
    }

    // âœ… Certify Track
    async function certifyTrack(docId) {
      const ipfs = document.getElementById(`ipfs-${docId}`).value.trim();
      if (!ipfs) return alert("Please enter IPFS link.");
      await db.collection("tracks").doc(docId).update({
        certified: true,
        ipfs
      });
      showToast("Track submitted!");
      loadPendingTracks();
      loadCertifiedTracks();
    }

    // âœ… Toast Handler
function showToast(message, duration = 3000) {
  const toast = document.getElementById("toast");
  toast.innerText = message;
  toast.style.display = "block";
  toast.style.opacity = "1";

  setTimeout(() => {
    toast.style.opacity = "0";
    setTimeout(() => {
      toast.style.display = "none";
    }, 300);
  }, duration);
}
  </script>
</body>
</html>
