<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Y2K Roast Records</title>
  <meta name="theme-color" content="#0c0c0f" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Space+Mono&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0b0d12;
      --neon-cyan: #00ffe7;
      --neon-pink: #ff00aa;
      --glitch-purple: #b300ff;
      --white: #f2f2f2;
      --font-glitch: 'Orbitron', sans-serif;
      --font-body: 'Space Mono', monospace;
    }
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      background-color: var(--bg);
      font-family: var(--font-body);
      color: var(--white);
      overflow-x: hidden;
    }
    header {
      text-align: center;
      padding: 1rem;
    }
    header img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
    }
    #logo {
      width: 128px;
      margin: 2rem auto 0;
      display: block;
    }
    h1 {
      font-family: var(--font-glitch);
      text-align: center;
      font-size: 2.8rem;
      margin: 1rem 0;
      color: var(--neon-cyan);
      text-shadow: 0 0 8px var(--neon-cyan);
    }
    button {
      background: transparent;
      border: 2px solid var(--neon-pink);
      color: var(--neon-pink);
      font-family: var(--font-body);
      font-weight: bold;
      padding: 0.75rem 1.5rem;
      margin-top: 1rem;
      cursor: pointer;
      transition: 0.3s ease;
    }
    button:hover {
      background: var(--neon-pink);
      color: var(--bg);
    }
    .container {
      max-width: 768px;
      margin: 0 auto;
      padding: 2rem;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-top: 2rem;
    }
    input, textarea {
      padding: 0.75rem;
      font-family: var(--font-body);
      border: 1px solid #333;
      background: #111;
      color: var(--white);
      border-radius: 4px;
    }
    .section {
      padding: 3rem 1rem;
      text-align: center;
    }
    .card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid #444;
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
    }
    audio {
      width: 100%;
      margin-top: 0.5rem;
    }
    @media (max-width: 480px) {
      h1 { font-size: 2rem; }
      button { width: 100%; }
    }
  </style>
</head>
<body>

<header>
  <img src="https://raw.githubusercontent.com/LandoCrissian/Y2kCoin-Website/refs/heads/main/IMG_7318.png" alt="Banner" />
  <img src="https://raw.githubusercontent.com/LandoCrissian/Y2kCoin-Website/refs/heads/main/AC6583AD-EE37-486D-8220-6555D24B0D9D.pong" alt="Logo" id="logo" />
</header>

<h1>Y2K Roast Records</h1>

<div class="container">
  <button id="connectWallet">Connect Wallet</button>

  <form id="requestForm">
    <input type="text" id="projectName" placeholder="Project Name" required />
    <input type="text" id="vibe" placeholder="Describe the Vibe" required />
    <input type="text" id="twitter" placeholder="ùïè Handle (optional)" />
    <button type="submit">Submit Song Request (30 CRO)</button>
  </form>

  <div class="section">
    <h2>Live Submissions</h2>
    <div id="submissions"></div>
  </div>

  <div class="section">
    <h2>üéß Certified Tracks</h2>
    <div id="certifiedGallery"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyByE3Z0Ui_aFr1JUgVzw3ZDatGv8DzqVcE",
  authDomain: "y2kroastrecords.firebaseapp.com",
  projectId: "y2kroastrecords",
  storageBucket: "y2kroastrecords.appspot.com",
  messagingSenderId: "313829428782",
  appId: "1:313829428782:web:4e42771ba525f6f297d9bf"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let currentAccount = null;
const treasuryWallet = "0x99FD6Daaa57ebE7f10Ee94E6c1b7522Fa2b0d100";
const adminWallet = "0x7FC2AB08F46C10489Bab5D694D574022f1048198";

async function connectWallet() {
  if (window.ethereum) {
    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
    currentAccount = accounts[0];
    document.getElementById('connectWallet').innerText = 'Connected: ' + currentAccount.slice(0, 6) + '...' + currentAccount.slice(-4);
  }
}

document.getElementById('connectWallet').onclick = connectWallet;

document.getElementById('requestForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  if (!currentAccount) return alert("Connect your wallet first");

  const provider = new ethers.providers.Web3Provider(window.ethereum);
  const signer = provider.getSigner();
  const tx = await signer.sendTransaction({
    to: treasuryWallet,
    value: ethers.utils.parseUnits("30", "ether")
  });
  await tx.wait();

  const projectName = document.getElementById("projectName").value;
  const vibe = document.getElementById("vibe").value;
  const twitter = document.getElementById("twitter").value;

  await db.collection("submissions").add({
    projectName,
    vibe,
    twitter,
    wallet: currentAccount,
    timestamp: Date.now()
  });

  alert("Request submitted successfully!");
});

function loadSubmissions() {
  db.collection("submissions").orderBy("timestamp", "desc").onSnapshot(snapshot => {
    const container = document.getElementById("submissions");
    container.innerHTML = "";
    snapshot.forEach(doc => {
      const d = doc.data();
      container.innerHTML += `<div class="card">
        <strong>${d.projectName}</strong><br>
        <em>${d.vibe}</em><br>
        ${d.twitter ? `<p>ùïè: ${d.twitter}</p>` : ""}
        <small>${d.wallet.slice(0, 6)}...${d.wallet.slice(-4)}</small>
      </div>`;
    });
  });
}

function loadCertifiedTracks() {
  db.collection("certified").orderBy("timestamp", "desc").onSnapshot(snapshot => {
    const gallery = document.getElementById("certifiedGallery");
    gallery.innerHTML = "";
    snapshot.forEach(doc => {
      const d = doc.data();
      gallery.innerHTML += `<div class="card">
        <strong>${d.projectName}</strong><br>
        <img src="${d.imageURL}" alt="cover" style="max-width:100%; border-radius:6px;" />
        <audio controls src="${d.audioURL}"></audio><br>
        <a href="${d.nftURL}" target="_blank">View NFT</a>
      </div>`;
    });
  });
}

window.onload = () => {
  connectWallet();
  loadSubmissions();
  loadCertifiedTracks();
};
</script>

</body>
</html>
