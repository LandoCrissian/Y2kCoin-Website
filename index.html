<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Y2K | Roast Records</title>

    <!-- SEO + Open Graph -->
    <meta name="description" content="The official home of Y2K | Roast Records ‚Äî glitch-dub-trap music label on Cronos." />
    <meta name="theme-color" content="#0b0d12" />
    <meta property="og:title" content="Y2K | Roast Records" />
    <meta property="og:description" content="Submit your track. Join the movement. Discover underground music on-chain." />
    <meta property="og:image" content="https://raw.githubusercontent.com/LandoCrissian/Y2kCoin-Website/refs/heads/main/IMG_7318.png" />
    <meta property="og:url" content="https://y2kcoin.org" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Favicon + Fonts -->
    <link rel="icon" href="https://raw.githubusercontent.com/LandoCrissian/Y2kCoin-Website/refs/heads/main/AC6583AD-EE37-486D-8220-6555D24B0D9D.png" />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore-compat.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyByE3Z0Ui_aFr1JUgVzw3ZDatGv8DzqVcE",
        authDomain: "y2kroastrecords.firebaseapp.com",
        projectId: "y2kroastrecords",
        storageBucket: "y2kroastrecords.firebasestorage.app",
        messagingSenderId: "313829428782",
        appId: "1:313829428782:web:4e42771ba525f6f297d9bf"
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
    </script>

    <style>
      html {
        font-family: 'Space Grotesk', sans-serif;
        scroll-behavior: smooth;
      }

      .glitch-hover:hover {
        animation: glitch 0.3s steps(2, end) infinite;
      }

      @keyframes glitch {
        0% { text-shadow: 1px 0 #00ffc3; }
        50% { text-shadow: -1px 0 #ff2aad; }
        100% { text-shadow: 1px 0 #00ffc3; }
      }

      @keyframes pulseLine {
        0%, 100% { opacity: 0.4; }
        50% { opacity: 1; }
      }
    </style>
  </head>

  <body class="bg-[#0b0d12] text-white overflow-x-hidden">
    <!-- Header -->
    <header class="fixed top-0 left-0 w-full z-50 bg-[#0b0d12] flex items-center justify-between px-4 py-3 border-b border-[#111]">
      <a href="#top" class="text-teal-300 font-semibold text-sm glitch-hover" tabindex="0" aria-label="Go to top" role="link">Y2K | Roast Records</a>
      <button
        class="bg-teal-300 text-black font-semibold text-sm px-4 py-2 rounded-md hover:bg-pink-500 hover:text-white transition"
        tabindex="0"
        aria-label="Connect Wallet"
        data-connected="false"
      >
        Connect Wallet
      </button>
    </header>

    <!-- Hero Banner -->
    <div class="mt-[64px] w-full max-h-[60vh] overflow-hidden">
      <img
        src="https://raw.githubusercontent.com/LandoCrissian/Y2kCoin-Website/refs/heads/main/IMG_7318.png"
        alt="Y2K Roast Records Banner"
        class="w-full object-cover aspect-[3/1]"
      />
    </div>

    <!-- Neon Line -->
    <div class="h-[3px] w-full bg-gradient-to-r from-pink-500 to-teal-300 shadow-md animate-[pulseLine_2.5s_ease-in-out_infinite]"></div>

    <!-- Main Content -->
    <main class="px-4 space-y-10 mt-6 pb-10">
      <!-- Certified Tracks -->
      <section id="featured">
        <h2 class="text-teal-300 text-xl font-semibold mb-4">üî• Certified Tracks</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="certifiedTracks">
          <div class="bg-[#111214] border border-[#222] p-4 rounded-lg">Track 001 ‚Äî Coming soon</div>
          <div class="bg-[#111214] border border-[#222] p-4 rounded-lg">Track 002 ‚Äî Glitchwave by V1RUS</div>
          <div class="bg-[#111214] border border-[#222] p-4 rounded-lg">Track 003 ‚Äî RawSignal by SYNAPS3</div>
        </div>
      </section>

      <!-- Submit Track -->
      <section id="submit">
        <h2 class="text-teal-300 text-xl font-semibold mb-4">üì§ Submit a Track</h2>
        <p class="mb-2">
          To submit your music to Y2K | Roast Records, connect your wallet and fill out the form. Cost:
          <strong class="text-pink-400">30 CRO</strong>
        </p>
        <p class="italic text-gray-400">[Form goes here]</p>
      </section>

      <!-- Live Submissions -->
      <section id="live">
        <h2 class="text-teal-300 text-xl font-semibold mb-4">üîÑ Live Submissions</h2>
        <p class="italic text-gray-400">[Real-time feed from Firestore here]</p>
      </section>

      <!-- FAQ -->
      <section id="faq">
        <h2 class="text-teal-300 text-xl font-semibold mb-4">‚ùì FAQ</h2>
        <p class="mb-2"><strong>Q:</strong> Who can submit?<br /><strong>A:</strong> Anyone with a Cronos wallet.</p>
        <p><strong>Q:</strong> What happens after approval?<br /><strong>A:</strong> You get immortalized in our on-chain catalog.</p>
      </section>

      <!-- Admin Panel -->
      <section id="adminPanel" class="hidden">
        <h2 class="text-teal-300 text-xl font-semibold mb-4">üîê Admin Panel</h2>
        <p class="text-sm text-gray-400 mb-4">Connected as admin. Manage all track submissions here.</p>
        <div id="adminTrackContainer" class="space-y-6">
          <p class="text-gray-500 italic">No pending submissions yet.</p>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="text-center text-sm text-gray-400 border-t border-[#111] py-8 px-4">
      <p>&copy; 2025 Y2K | Roast Records ‚Äî Built for the CROfam</p>
      <div class="mt-4 space-x-4">
        <a href="https://x.com/y2kc0in?s=21" target="_blank" class="text-teal-300 glitch-hover" aria-label="Visit X profile" tabindex="0">ùïè</a>
        <a href="https://discord.gg/jpFbSapSAh" target="_blank" class="text-teal-300 glitch-hover" aria-label="Join Discord" tabindex="0">Discord</a>
        <a href="https://obsidian.finance/?outputCurrency=0xB4Df7d2A736Cc391146bB0dF4277E8F68247Ac6d" target="_blank" class="text-teal-300 glitch-hover" aria-label="Buy Token" tabindex="0">Buy Token</a>
      </div>
    </footer>

    <!-- Wallet Connect + Firestore Logic -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const ADMIN_ADDRESS = "0x7fc2ab08f46c10489bab5d694d574022f1048198".toLowerCase();
        const adminPanel = document.getElementById("adminPanel");
        const walletBtn = document.querySelector("[aria-label^='Connect']");

        walletBtn.addEventListener("click", () => {
          const isConnected = walletBtn.dataset.connected === "true";
          if (isConnected) {
            handleDisconnectWallet();
          } else {
            handleConnectWallet();
          }
        });

        walletBtn.addEventListener("keydown", (e) => {
          if (e.key === "Enter") walletBtn.click();
        });

        const updateButtonUI = (connected, address = "") => {
          walletBtn.textContent = connected ? "Disconnect" : "Connect Wallet";
          walletBtn.dataset.connected = connected ? "true" : "false";
          walletBtn.setAttribute("aria-label", connected ? `Disconnect Wallet ${address}` : "Connect Wallet");
          if (!connected) adminPanel.classList.add("hidden");
        };

        const handleConnectWallet = async () => {
          if (!window.ethereum) return alert("Please install MetaMask.");
          try {
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            const signer = provider.getSigner();
            const address = (await signer.getAddress()).toLowerCase();
            const message = `Sign in to Y2K | Roast Records\n\nWallet: ${address}`;
            await signer.signMessage(message);
            localStorage.setItem("connectedWallet", address);
            updateButtonUI(true, address);
            if (address === ADMIN_ADDRESS) {
              adminPanel.classList.remove("hidden");
              loadAdminTracks();
            }
          } catch (err) {
            alert("Connection failed.");
            console.error(err);
          }
        };

        const handleDisconnectWallet = () => {
          localStorage.removeItem("connectedWallet");
          updateButtonUI(false);
          alert("Disconnected.");
        };

        const autoReconnect = () => {
          const saved = localStorage.getItem("connectedWallet");
          if (saved) {
            updateButtonUI(true, saved);
            if (saved === ADMIN_ADDRESS) {
              adminPanel.classList.remove("hidden");
              loadAdminTracks();
            }
          } else {
            updateButtonUI(false);
          }
        };

        autoReconnect();
      });

      const adminTrackContainer = document.getElementById("adminTrackContainer");

      const renderTrackCard = (docId, data) => {
        const wrapper = document.createElement("div");
        wrapper.className = "bg-[#111214] border border-[#222] rounded-lg p-4 space-y-4 shadow-sm";

        wrapper.innerHTML = `
          <div class="flex flex-col gap-2">
            <label class="text-sm text-gray-300 font-semibold">Track Title</label>
            <input type="text" value="${data.title || ''}" class="bg-[#0b0d12] border border-[#333] text-white text-sm p-2 rounded-md" disabled />
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-sm text-gray-300 font-semibold">IPFS URL</label>
            <input type="text" value="${data.ipfsUrl || ''}" class="ipfs-url bg-[#0b0d12] border border-[#333] text-white text-sm p-2 rounded-md" placeholder="ipfs://..." />
          </div>
          <div class="flex gap-4 pt-2">
            <button class="approve-btn bg-teal-500 text-black text-sm px-4 py-2 rounded-md font-semibold hover:bg-teal-400 transition">Approve</button>
            <button class="reject-btn bg-pink-600 text-white text-sm px-4 py-2 rounded-md font-semibold hover:bg-pink-500 transition">Reject</button>
          </div>
        `;

        wrapper.querySelector(".approve-btn").addEventListener("click", async () => {
          const ipfsUrl = wrapper.querySelector(".ipfs-url").value.trim();
          if (!ipfsUrl.startsWith("ipfs://")) return alert("Invalid IPFS URL.");
          await db.collection("submissions").doc(docId).update({ status: "approved", ipfsUrl });
          alert("‚úÖ Approved.");
          wrapper.remove();
        });

        wrapper.querySelector(".reject-btn").addEventListener("click", async () => {
          await db.collection("submissions").doc(docId).update({ status: "rejected" });
          alert("‚ùå Rejected.");
          wrapper.remove();
        });

        adminTrackContainer.appendChild(wrapper);
      };

      const loadAdminTracks = async () => {
        try {
          const snapshot = await db.collection("submissions")
            .where("status", "==", "pending")
            .orderBy("timestamp", "desc")
            .get();

          adminTrackContainer.innerHTML = "";

          if (snapshot.empty) {
            adminTrackContainer.innerHTML = `<p class="text-gray-500 italic">No pending submissions yet.</p>`;
            return;
          }

          snapshot.forEach(doc => renderTrackCard(doc.id, doc.data()));
        } catch (err) {
          console.error("Firestore error:", err);
          adminTrackContainer.innerHTML = `<p class="text-pink-400">Error loading tracks.</p>`;
        }
      };
    </script>
  </body>
</html>
