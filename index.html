<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
<title>Y2K Bet-Fi — Cronos</title>
<meta name="theme-color" content="#0b0b0c">
<meta name="description" content="Y2K Bet-Fi on Cronos. Transparent bets. Bankroll growth. Buybacks for Y2K.">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<style>
  :root{
    --bg:#0b0b0c; --card:#121316; --muted:#16171b; --text:#f3f4f6; --sub:#b9beca;
    --gold:#d4af37; --gold-2:#b9972a; --line:rgba(255,255,255,.08);
  }
  html,body{background:var(--bg); color:var(--text); font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.02),transparent 25%),var(--card); border:1px solid var(--line); border-radius:14px;}
  .btn{border:1px solid var(--line); background:linear-gradient(180deg,#1a1b1f,#131419); border-radius:10px; padding:.7rem 1rem; font-weight:600}
  .btn:hover{border-color:rgba(212,175,55,.35)}
  .btn-gold{background:linear-gradient(180deg,var(--gold),var(--gold-2)); color:#111; border-color:transparent}
  .kpi-label{font-size:.72rem; letter-spacing:.02em; color:var(--sub)}
  .kpi-value{font-size:1.4rem; font-weight:700}
  .chip{font-size:.7rem; padding:.2rem .5rem; border-radius:999px; border:1px solid var(--line)}
  .chip.win{background:rgba(34,197,94,.12); border-color:rgba(34,197,94,.35); color:#d1fae5}
  .chip.loss{background:rgba(239,68,68,.12); border-color:rgba(239,68,68,.35); color:#ffe2e2}
  .chip.live{background:rgba(16,185,129,.12); border-color:rgba(16,185,129,.35); color:#d7fff1}
  .chip.pending{background:rgba(245,158,11,.12); border-color:rgba(245,158,11,.35); color:#fff3da}
  .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace}
  .gold-text{color:var(--gold)}
  .divider{height:1px; background:var(--line)}
</style>
</head>
<body>

<!-- Top Bar -->
<header class="sticky top-0 z-40 border-b border-[color:var(--line)] bg-[color:rgba(11,11,12,.65)] backdrop-blur">
  <div class="max-w-6xl mx-auto flex items-center justify-between px-4 py-3">
    <div class="flex items-center gap-3">
      <div class="w-8 h-8 rounded bg-[color:var(--gold)]"></div>
      <div class="text-sm uppercase tracking-wide text-[color:var(--sub)]">Y2K • Bet-Fi</div>
    </div>
    <nav class="hidden sm:flex items-center gap-2">
      <a href="#bets" class="btn text-sm">Live Bets</a>
      <a href="#buybacks" class="btn text-sm">Buyback Ledger</a>
      <a href="https://obsidian.finance/?outputCurrency=0xB4Df7d2A736Cc391146bB0dF4277E8F68247Ac6d" target="_blank" class="btn btn-gold text-sm">Buy Y2K</a>
    </nav>
  </div>
</header>

<main>
  <!-- Hero -->
  <section class="max-w-6xl mx-auto px-4 pt-8 pb-6">
    <div class="grid md:grid-cols-2 gap-6 items-center">
      <div>
        <h1 class="text-3xl md:text-4xl font-bold leading-tight">Professional Bet-Fi on <span class="gold-text">Cronos</span></h1>
        <p class="text-[color:var(--sub)] mt-3">Transparent slips. Disciplined bankroll. A fixed share of wins purchases <span class="gold-text">$Y2K</span> on-chain. No fluff—just the numbers.</p>
        <div class="flex gap-2 mt-4">
          <a href="#bets" class="btn">View Bets</a>
          <a href="#buybacks" class="btn">Ledger</a>
        </div>
      </div>
      <div class="card p-4">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
          <div class="p-3 rounded bg-[color:var(--muted)] border border-[color:var(--line)]">
            <div class="kpi-label">Bankroll</div>
            <div id="kpi-bankroll" class="kpi-value mono">$—</div>
          </div>
          <div class="p-3 rounded bg-[color:var(--muted)] border border-[color:var(--line)]">
            <div class="kpi-label">Buybacks</div>
            <div id="kpi-buybacks" class="kpi-value mono">$—</div>
          </div>
          <div class="p-3 rounded bg-[color:var(--muted)] border border-[color:var(--line)]">
            <div class="kpi-label">Hit Rate</div>
            <div id="kpi-hitrate" class="kpi-value mono">—%</div>
          </div>
          <div class="p-3 rounded bg-[color:var(--muted)] border border-[color:var(--line)]">
            <div class="kpi-label">Best Payout</div>
            <div id="kpi-best" class="kpi-value mono">$—</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Bets + Buybacks -->
  <section id="bets" class="max-w-6xl mx-auto px-4 pb-6 grid lg:grid-cols-2 gap-4">
    <!-- Bets -->
    <div class="card p-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="text-lg font-semibold">Live Bets & Results</h2>
        <button id="btn-add-bet" class="btn text-xs px-3 py-1">+ Add Bet</button>
      </div>
      <div id="betsList" class="space-y-2"></div>
    </div>

    <!-- Buybacks -->
    <div id="buybacks" class="card p-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="text-lg font-semibold">Buyback Ledger</h2>
        <button id="btn-add-buyback" class="btn text-xs px-3 py-1">+ Add Buyback</button>
      </div>
      <div id="buybacksList" class="space-y-2"></div>
    </div>
  </section>

  <!-- Wins -->
  <section class="max-w-6xl mx-auto px-4 pb-10">
    <div class="card p-4">
      <div class="flex items-center justify-between mb-3">
        <h3 class="font-semibold">Recent Big Wins</h3>
        <span class="text-xs text-[color:var(--sub)]">Auto-generated from bet results</span>
      </div>
      <div id="winsTimeline" class="space-y-2"></div>
    </div>
  </section>
</main>

<!-- Footer -->
<footer class="border-t border-[color:var(--line)]">
  <div class="max-w-6xl mx-auto px-4 py-6 text-sm text-[color:var(--sub)] flex flex-col md:flex-row items-center justify-between gap-3">
    <div>© <span id="year"></span> Y2K • Bet-Fi on Cronos</div>
    <div class="flex items-center gap-4">
      <a class="hover:underline" href="https://discord.gg/XxtpYNXX4a" target="_blank">Discord</a>
      <a class="hover:underline" href="https://x.com/y2kc0in?s=21" target="_blank">X</a>
      <a class="hover:underline" href="https://y2k-the-vault.netlify.app/" target="_blank">Vault (Archive)</a>
    </div>
  </div>
</footer>

<!-- Modals -->
<div id="betModal" class="fixed inset-0 hidden items-center justify-center bg-black/70 p-4 z-50">
  <div class="card w-full max-w-md p-5">
    <h3 class="text-lg font-semibold mb-3">Add Bet</h3>
    <div class="grid gap-2">
      <input id="betTitle" class="w-full p-2 rounded bg-[color:var(--muted)] border border-[color:var(--line)]" placeholder="Title (e.g., 3-Leg HR Parlay)">
      <input id="betMarket" class="w-full p-2 rounded bg-[color:var(--muted)] border border-[color:var(--line)]" placeholder="Market / Odds (e.g., HR Parlay • +6600)">
      <input id="betPayout" class="w-full p-2 rounded bg-[color:var(--muted)] border border-[color:var(--line)]" placeholder="Potential payout USD">
    </div>
    <div class="flex gap-2 justify-end mt-4">
      <button id="saveBetBtn" class="btn text-sm">Save</button>
      <button id="closeBetBtn" class="btn text-sm">Close</button>
    </div>
  </div>
</div>

<div id="buybackModal" class="fixed inset-0 hidden items-center justify-center bg-black/70 p-4 z-50">
  <div class="card w-full max-w-md p-5">
    <h3 class="text-lg font-semibold mb-3">Add Buyback</h3>
    <div class="grid gap-2">
      <input id="bbUSD" class="w-full p-2 rounded bg-[color:var(--muted)] border border-[color:var(--line)]" placeholder="USD amount">
      <input id="bbAmount" class="w-full p-2 rounded bg-[color:var(--muted)] border border-[color:var(--line)]" placeholder="Y2K amount">
      <input id="bbTx" class="w-full p-2 rounded bg-[color:var(--muted)] border border-[color:var(--line)]" placeholder="Cronoscan tx URL">
      <input id="bbNote" class="w-full p-2 rounded bg-[color:var(--muted)] border border-[color:var(--line)]" placeholder="Note (optional)">
    </div>
    <div class="flex gap-2 justify-end mt-4">
      <button id="saveBuybackBtn" class="btn text-sm">Save</button>
      <button id="closeBuybackBtn" class="btn text-sm">Close</button>
    </div>
  </div>
</div>

<!-- Firebase + Logic -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import {
    getFirestore, doc, getDoc, setDoc, updateDoc,
    collection, addDoc, onSnapshot, query, orderBy, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  // --- Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyCLGt0gVlI8BKdrpME4IefwVjF_ehJJmug",
    authDomain: "y2kroast-512ee.firebaseapp.com",
    projectId: "y2kroast-512ee",
    storageBucket: "y2kroast-512ee.appspot.com",
    messagingSenderId: "602588659855",
    appId: "1:602588659855:web:f01efa4b81e737d26270fa"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // --- UI refs
  const K = {
    bankroll: document.getElementById('kpi-bankroll'),
    buybacks: document.getElementById('kpi-buybacks'),
    hitrate:  document.getElementById('kpi-hitrate'),
    best:     document.getElementById('kpi-best'),
  };
  const lists = {
    bets: document.getElementById('betsList'),
    buy:  document.getElementById('buybacksList'),
    wins: document.getElementById('winsTimeline')
  };
  document.getElementById('year').textContent = new Date().getFullYear();

  // --- helpers
  const fmtUSD = n => (n==null||isNaN(n)) ? "$—" : Number(n).toLocaleString(undefined,{style:"currency",currency:"USD",maximumFractionDigits:0});
  const tsTxt = t => t?.toDate ? t.toDate().toLocaleString() : "";

  // --- Stats stream
  const statsRef = doc(db, "stats", "bankroll");
  onSnapshot(statsRef, (snap)=>{
    const s = snap.exists()? snap.data() : {bankroll:0,buybacksUSD:0,hitRate:0,bestPayout:0};
    K.bankroll.textContent = fmtUSD(s.bankroll||0);
    K.buybacks.textContent = fmtUSD(s.buybacksUSD||0);
    K.hitrate.textContent  = ((s.hitRate||0)*100).toFixed(1) + "%";
    K.best.textContent     = fmtUSD(s.bestPayout||0);
  });

  // --- Bets stream
  const betsQ = query(collection(db,"bets"), orderBy("ts","desc"));
  onSnapshot(betsQ, (snap)=>{
    lists.bets.innerHTML = snap.empty ? `<div class="text-sm text-[color:var(--sub)]">No bets yet.</div>` : "";
    lists.wins.innerHTML = "";
    snap.docs.forEach(d=>{
      const b = { id:d.id, ...d.data() };
      const status = (b.status||"pending").toLowerCase();
      const chip =
        status === "win"   ? "chip win" :
        status === "loss"  ? "chip loss" :
        status === "live"  ? "chip live" :
                             "chip pending";

      const row = document.createElement('div');
      row.className = "flex items-center justify-between gap-3 p-3 rounded bg-[color:var(--muted)] border border-[color:var(--line)]";
      row.innerHTML = `
        <div>
          <div class="font-semibold">${b.title||"—"}</div>
          <div class="text-xs text-[color:var(--sub)]">${b.market||""} • ${tsTxt(b.ts)}</div>
        </div>
        <div class="flex items-center gap-2">
          <span class="${chip}">${(b.status||"PENDING").toUpperCase()}</span>
          <div class="mono">${b.payout ? fmtUSD(b.payout) : ""}</div>
        </div>
      `;
      lists.bets.appendChild(row);

      if(status==="win"){
        const win = document.createElement('div');
        win.className = "flex items-center justify-between p-3 rounded bg-[color:var(--muted)] border border-green-600/30";
        win.innerHTML = `<div class="text-sm">${b.title||"—"} <span class="text-[color:var(--sub)]">• ${b.market||""}</span></div>
                         <div class="mono font-semibold text-green-400">${fmtUSD(b.payout||0)}</div>`;
        lists.wins.appendChild(win);
      }
    });
  });

  // --- Buybacks stream
  const buyQ = query(collection(db,"buybacks"), orderBy("ts","desc"));
  onSnapshot(buyQ, (snap)=>{
    lists.buy.innerHTML = snap.empty ? `<div class="text-sm text-[color:var(--sub)]">No buybacks yet.</div>` : "";
    snap.docs.forEach(d=>{
      const x = { id:d.id, ...d.data() };
      const row = document.createElement('div');
      row.className = "flex items-center justify-between gap-3 p-3 rounded bg-[color:var(--muted)] border border-[color:var(--line)]";
      row.innerHTML = `
        <div>
          <div class="font-semibold">Buyback ${fmtUSD(x.usd||0)}</div>
          <div class="text-xs text-[color:var(--sub)]">${x.note||"Automated"} • ${tsTxt(x.ts)}</div>
        </div>
        <div class="flex items-center gap-2">
          <div class="mono text-sm">${x.amount ? `${x.amount} Y2K` : ""}</div>
          ${x.tx ? `<a href="${x.tx}" target="_blank" rel="noopener" class="btn text-xs px-2 py-1">Tx</a>` : ""}
        </div>
      `;
      lists.buy.appendChild(row);
    });
  });

  // --- Admin modals (optional): remove this block if you don’t want inline creation
  const betModal = document.getElementById('betModal');
  const buyModal = document.getElementById('buybackModal');
  const show = el => el?.classList.replace("hidden","flex");
  const hide = el => el?.classList.replace("flex","hidden");
  document.getElementById('btn-add-bet')?.addEventListener('click',()=>show(betModal));
  document.getElementById('closeBetBtn')?.addEventListener('click',()=>hide(betModal));
  document.getElementById('btn-add-buyback')?.addEventListener('click',()=>show(buyModal));
  document.getElementById('closeBuybackBtn')?.addEventListener('click',()=>hide(buyModal));

  document.getElementById('saveBetBtn')?.addEventListener('click', async ()=>{
    const title  = document.getElementById('betTitle').value.trim();
    const market = document.getElementById('betMarket').value.trim();
    const payout = Number(document.getElementById('betPayout').value.trim());
    if(!title) return alert("Title required");
    await addDoc(collection(db,"bets"), { title, market, payout: isNaN(payout)? null : payout, status:"pending", ts: serverTimestamp() });
    ["betTitle","betMarket","betPayout"].forEach(id=>document.getElementById(id).value="");
    hide(betModal);
  });

  document.getElementById('saveBuybackBtn')?.addEventListener('click', async ()=>{
    const usd = Number(document.getElementById('bbUSD').value.trim());
    const amount = Number(document.getElementById('bbAmount').value.trim());
    const tx = document.getElementById('bbTx').value.trim();
    const note = document.getElementById('bbNote').value.trim();
    await addDoc(collection(db,"buybacks"), { usd:isNaN(usd)?0:usd, amount:isNaN(amount)?0:amount, tx, note, ts: serverTimestamp() });

    // bump cumulative buybacks in stats
    const sSnap = await getDoc(statsRef);
    const curr = sSnap.exists()? (sSnap.data().buybacksUSD||0) : 0;
    await setDoc(statsRef, { buybacksUSD: curr + (isNaN(usd)?0:usd) }, { merge:true });

    ["bbUSD","bbAmount","bbTx","bbNote"].forEach(id=>document.getElementById(id).value="");
    hide(buyModal);
  });
</script>

</body>
</html>
