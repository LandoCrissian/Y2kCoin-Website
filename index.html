<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Y2K | Roast Records</title>
  <meta name="description" content="The official site of Y2K | Roast Records ‚Äî a premium Web3 music label on Cronos." />
  <meta name="theme-color" content="#000000" />
  <link rel="icon" href="https://raw.githubusercontent.com/LandoCrissian/Y2kCoin-Website/main/AC6583AD-EE37-486D-8220-6555D24B0D9D.png" />
  <style>
    body {
      margin: 0;
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #0a0a0a;
      color: #f5f5f5;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background-color: #000;
      border-bottom: 1px solid #222;
    }
    .logo {
      font-size: 20px;
      font-weight: bold;
      color: #f5f5f5;
      text-transform: uppercase;
    }
    .wallet-btn {
      background-color: #d6b66c;
      color: #000;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    .hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;
    }
    .hero h1 {
      font-size: 32px;
      margin-bottom: 12px;
    }
    .hero p {
      font-size: 16px;
      color: #ccc;
      max-width: 600px;
    }
    section {
      padding: 40px 20px;
      border-top: 1px solid #1a1a1a;
    }
    h2 {
      font-size: 22px;
      margin-bottom: 16px;
      color: #d6b66c;
    }
    form input, form textarea, form select {
      display: block;
      width: 100%;
      margin-bottom: 16px;
      padding: 10px;
      font-size: 16px;
      background: #111;
      color: #f5f5f5;
      border: 1px solid #333;
      border-radius: 6px;
    }
    form button {
      padding: 12px 24px;
      font-size: 16px;
      font-weight: bold;
      background-color: #d6b66c;
      color: #000;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .track-card {
      background-color: #111;
      border: 1px solid #222;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 20px;
    }
    .admin-panel {
      background: #111;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #333;
    }
    .hidden { display: none; }

    .track-card {
  background-color: #111;
  border: 1px solid #222;
  border-radius: 10px;
  padding: 16px;
  margin-bottom: 24px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  transition: transform 0.2s ease;
}
.track-card:hover {
  transform: translateY(-2px);
}
.track-meta {
  font-size: 13px;
  color: #aaa;
  margin-bottom: 8px;
}
.genre-pill {
  display: inline-block;
  background-color: #d6b66c;
  color: #000;
  font-size: 11px;
  font-weight: bold;
  padding: 4px 8px;
  border-radius: 20px;
  margin-right: 6px;
  text-transform: uppercase;
}
.certified-badge {
  background-color: #d6b66c;
  color: #000;
  font-size: 12px;
  font-weight: bold;
  padding: 4px 10px;
  border-radius: 999px;
  display: inline-block;
  margin-top: 6px;
}
.audio-wrapper {
  margin-top: 10px;
}

    .cro-payment-instructions {
  background-color: #111;
  border-left: 4px solid #00ffd0;
  padding: 12px;
  margin-top: 16px;
  font-size: 0.9rem;
  color: #ccc;
}
  </style>

  <!-- WalletConnect / Web3Modal v2 -->
<script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web3modal@1.9.5/dist/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
</head>
<body>
  <header>
    <div class="logo">Y2K | Roast Records</div>
    <button id="connectWallet" class="wallet-btn">Connect Wallet</button>
  </header>

  <!-- Toast Container -->
<div id="toast" style="
  display:none;
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #d6b66c;
  color: #000;
  padding: 14px 24px;
  border-radius: 8px;
  font-weight: bold;
  font-size: 14px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  z-index: 9999;
  transition: all 0.3s ease;
"></div>

  <div class="hero">
    <h1>A New Era of Music</h1>
    <p>Y2K | Roast Records is the first premium Web3 label for real and AI artists ‚Äî built on Cronos, powered by community, and open to anyone who dares to drop heat.</p>
  </div>

    <section class="section" id="submit">
  <h2>Submit a Track</h2>
  <form id="submission-form">
    <label for="name">Project / Artist Name</label>
    <input type="text" id="name" required placeholder="Enter artist or project name" />

    <label for="twitter">Twitter / X Handle</label>
    <input type="text" id="twitter" required placeholder="@yourhandle" />

    <label for="vibe">Select Genre / Vibe</label>
    <select id="vibe" required>
      <option value="" disabled selected>Select a genre</option>
      <option value="Glitch">Glitch</option>
      <option value="Dub">Dub</option>
      <option value="Trap">Trap</option>
      <option value="Hip-Hop">Hip-Hop</option>
      <option value="R&B / Soul">R&B / Soul</option>
      <option value="Rock / Metal">Rock / Metal</option>
      <option value="Pop">Pop</option>
      <option value="EDM / Dance">EDM / Dance</option>
      <option value="Country">Country</option>
      <option value="Reggaeton">Reggaeton</option>
      <option value="Afrobeats">Afrobeats</option>
      <option value="Other">Other</option>
    </select>

    <label for="notes">Optional Notes</label>
    <textarea id="notes" placeholder="Add any extra context or vibe requests..."></textarea>

    <button type="submit">Submit Track Request</button>

    <p class="cro-payment-instructions">
      <strong>‚ö†Ô∏è 30 CRO Required:</strong><br>
      After submitting, send <strong>30 CRO</strong> to:<br>
      <code>0x99FD6Daaa57ebE7f10Ee94E6c1b7522Fa2b0d100</code><br>
      This funds the anthem and supports buybacks.
    </p>
  </form>
</section>

  <section id="certifiedTracks">
    <h2>Certified Tracks</h2>
    <div id="certifiedList"></div>
  </section>

  <section id="adminPanel" class="hidden">
    <h2>Admin Panel</h2>
    <div class="admin-panel">
      <p><strong>Pending Submissions</strong></p>
      <div id="pendingList"></div>
    </div>
  </section>

  <!-- Firebase + JS Logic -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore-compat.js"></script>
  <script>
  // üîê Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyByE3Z0Ui_aFr1JUgVzw3ZDatGv8DzqVcE",
    authDomain: "y2kroastrecords.firebaseapp.com",
    projectId: "y2kroastrecords",
    storageBucket: "y2kroastrecords.appspot.com",
    messagingSenderId: "313829428782",
    appId: "1:313829428782:web:4e42771ba525f6f297d9bf"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const connectBtn = document.getElementById("connectWallet");
  const submissionSection = document.getElementById("submissionSection");
  const adminPanel = document.getElementById("adminPanel");
  const certifiedList = document.getElementById("certifiedList");
  const pendingList = document.getElementById("pendingList");

  let userAddress = null;
  const adminWallet = "0x7FC2AB08F46C10489Bab5D694D574022f1048198".toLowerCase();

  let web3Modal;
  let provider;
  let web3;
  let selectedAccount = null;

  async function initWalletModal() {
    const providerOptions = {
      walletconnect: {
        package: window.WalletConnectProvider.default,
        options: {
          rpc: {
            25: "https://evm.cronos.org"
          },
          chainId: 25
        }
      }
    };

    web3Modal = new window.Web3Modal.default({
      cacheProvider: false,
      providerOptions
    });
  }

  async function connectWallet() {
  try {
    provider = await web3Modal.connect();
    web3 = new Web3(provider);

    const accounts = await web3.eth.getAccounts();
    if (!accounts || accounts.length === 0) {
      showToast("No accounts found.");
      return;
    }

    selectedAccount = accounts[0].toLowerCase();
    const chainId = await web3.eth.getChainId();

    if (chainId !== 25) {
      showToast("Please switch to Cronos (Chain ID 25)");
      return;
    }

    try {
      const message = "Sign to connect to Y2K | Roast Records";
      await web3.eth.personal.sign(message, selectedAccount, "");
    } catch (signError) {
      console.warn("Signature rejected:", signError);
      showToast("Signature required to continue.");
      return;
    }

    // ‚úÖ Connection + signature successful
    userAddress = selectedAccount;
    const short = `${selectedAccount.slice(0, 6)}...${selectedAccount.slice(-4)}`;
    connectBtn.textContent = short;
    connectBtn.onclick = disconnectWallet;

    submissionSection.classList.remove("hidden");

    if (selectedAccount === adminWallet) {
      adminPanel.classList.remove("hidden");
      loadPendingTracks();
    }

    loadCertifiedTracks();
    showToast("Wallet connected successfully ‚úÖ");

  } catch (err) {
    console.error("Unexpected connection error:", err);
    if (!userAddress) {
      showToast("Failed to connect to wallet. Try again.");
    }
  }
}

  function disconnectWallet() {
    provider = null;
    selectedAccount = null;
    web3Modal.clearCachedProvider();
    connectBtn.textContent = "Connect Wallet";
    connectBtn.onclick = connectWallet;
    submissionSection.classList.add("hidden");
    adminPanel.classList.add("hidden");
  }

  window.addEventListener("load", () => {
    initWalletModal();
    connectBtn.onclick = connectWallet;
  });

  // üìù Submit Track to Firestore
  document.getElementById("trackForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("projectName").value;
    const twitter = document.getElementById("twitterHandle").value;
    const vibe = document.getElementById("vibeSelect").value;
    const notes = document.getElementById("notes").value;

    await db.collection("tracks").add({
      name,
      twitter,
      vibe,
      notes,
      wallet: userAddress,
      timestamp: Date.now(),
      certified: false,
      ipfs: ""
    });

    showToast("Track submitted!");
    e.target.reset();
  });

  // üéß Load Certified Tracks
async function loadCertifiedTracks() {
  const snapshot = await db.collection("tracks").where("certified", "==", true).orderBy("timestamp", "desc").get();
  certifiedList.innerHTML = "";
  snapshot.forEach(doc => {
    const data = doc.data();
    const date = new Date(data.timestamp).toLocaleDateString();

    const card = document.createElement("div");
    card.className = "track-card";
    card.innerHTML = `
      <div class="track-meta">
        <span class="genre-pill">#${data.vibe}</span>
        <span>${date}</span>
      </div>
      <strong>${data.name}</strong><br/>
      <small>${data.twitter}</small>
      <div class="audio-wrapper">
        <audio controls src="https://ipfs.io/ipfs/${data.ipfs}" style="width:100%"></audio>
      </div>
      <div class="certified-badge">‚úì Certified</div>
    `;
    certifiedList.appendChild(card);
  });
}

  // üõ†Ô∏è Load & Certify Tracks (Admin Only)
  async function loadPendingTracks() {
    const snapshot = await db.collection("tracks").where("certified", "==", false).orderBy("timestamp", "desc").get();
    pendingList.innerHTML = "";
    snapshot.forEach(doc => {
      const data = doc.data();
      const card = document.createElement("div");
      card.className = "track-card";
      card.innerHTML = `
        <strong>${data.name}</strong><br/>
        <small>${data.vibe} ‚Äî ${data.twitter}</small><br/>
        Wallet: ${data.wallet}<br/>
        Notes: ${data.notes || "‚Äî"}<br/><br/>
        <input type="text" placeholder="IPFS link" id="ipfs-${doc.id}" />
        <button onclick="certifyTrack('${doc.id}')">Certify</button>
      `;
      pendingList.appendChild(card);
    });
  }

  // ‚úÖ Certify Track
  async function certifyTrack(docId) {
    const ipfs = document.getElementById(`ipfs-${docId}`).value.trim();
    if (!ipfs) return showToast("Please enter IPFS link.");
    await db.collection("tracks").doc(docId).update({
      certified: true,
      ipfs
    });
    showToast("Track certified!");
    loadPendingTracks();
    loadCertifiedTracks();
  }

  // ‚úÖ Toast Handler
  function showToast(message, duration = 3000) {
    const toast = document.getElementById("toast");
    toast.innerText = message;
    toast.style.display = "block";
    toast.style.opacity = "1";

    setTimeout(() => {
      toast.style.opacity = "0";
      setTimeout(() => {
        toast.style.display = "none";
      }, 300);
    }, duration);
  }
</script>
</body>
</html>
